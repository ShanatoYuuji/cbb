<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="keywords" content="一矢光明的主页" />
		<meta name="description" content="数据库查询ajax" />
		<title>数据库查询</title>
	</head>

	<body>
		<div id="myDdv">
			<h3>JY查询</h3>
			<!--
            	作者：491128833@qq.com
            	时间：2017-03-12
            	描述：
            <input type="button" onclick="" value="change Content"></input>
    		<button onclick="loadXMLDoc('test_xmlhttp2.txt')">Click</button>
           -->
         	<label>查询内容</label>
			<input  id="intxt_para" type="text" />
			<label>页码数</label>
			<input type="button" value="<" onclick="eg.uppage()"/>
			<input id="pagecount" type="number" value="1"/>
			<input type="button" value=">" onclick="eg.downpage()" />
			<button onclick="eg.searchee()">查询</button>
			<div id="T1" style="border:1px solid black;"></div><br />
		</div>
	</body>

<link rel="stylesheet" href="../css/dbsearchajax.css" />

	<script type="text/javascript">
		
		var eg={};
		eg.searchee=function (){
			var searchpara=eg.$('intxt_para').value;
			loadXMLDoc(searchpara);
		}
		eg.$=function(id){
			return document.getElementById(id);
		}
		
		var xmlhttp;
		function loadXMLDoc(url) {
			xmlhttp = null;
			if(window.XMLHttpRequest) {
				xmlhttp = new XMLHttpRequest();
			}
			if(xmlhttp != null) {
				xmlhttp.onreadystatechange = state_Change;
				url=url+".";
				url=url+document.getElementById("pagecount").value;
				xmlhttp.open("GET", url, true);
				xmlhttp.send(null);
			} else {
				alert("Your browser does not support XMLHTTP.")
			}
		}

		function state_Change() {
			if(xmlhttp.readyState == 4) {
				if(xmlhttp.status == 200) {
					//200="OK"
					document.getElementById('T1').innerHTML = xmlhttp.responseText;
				} else {
					alert("Problem retrieving data:" + xmlhttp.statusText);
				}
			}
		}
		eg.uppage=function(){
			eg.$('pagecount').value=parseInt(eg.$('pagecount').value)-1;
		}
		eg.downpage=function(){
			eg.$('pagecount').value=parseFloat(eg.$('pagecount').value)+1;
		}
	</script>
</html>